Follow test driven design.

- Write a failing test.
- Impl the failing test.
- Remove duplicates.
- Cleanup.